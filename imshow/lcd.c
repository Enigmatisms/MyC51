#include<reg52.h>
#define LCD P0
#define uint unsigned int
#define uchar unsigned char
void Initiallize_LCD();//
void ShowString(uchar x,uchar y,uchar *str);
uchar code Display[31]="Hello world from 51 Panda image";

unsigned char a,i,j,k;
int b;
sbit EN=P2^0;
sbit RW=P2^1;
sbit RS=P2^2;
sbit CS1=P2^3;
sbit CS2=P2^4;
sbit BUSY=P0^0;
char code ch[8][128]={
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x80,0x80,0x00,0xC0,0x00,0x00,0x00,0x66,0x70,0x40,0x80,0xF0,0xF8,0xFC,0xFE,0xFE,
0xFF,0xFF,0xFF,0x7F,0x7F,0x7F,0x7E,0x7E,0x7C,0x70,0xE0,0xE0,0xEF,0xE7,0xC3,0xC2,
0xB3,0x07,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x80,0x80,0xC3,0xE3,0x72,0x3B,0x1C,0x0E,0x07,0x07,0x0B,0x01,0x03,0x03,0x03,0x8B,
0xC9,0xC8,0xC0,0xE0,0xE0,0xE0,0xC0,0xC0,0x00,0x06,0x00,0x0C,0xB0,0xD0,0xD0,0xD1,
0x83,0x1F,0xFF,0xFF,0xFF,0xFE,0xFE,0x7C,0x00,0x00,0x30,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x38,0x8C,0xE7,0xF0,0xFC,0xFE,0xFE,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFD,0xF0,0xF0,0xE0,0xC0,0x00,0x00,0x00,0x00,0x00,0x0F,0x1F,0x9F,
0xDF,0x9F,0x1F,0x1F,0xCF,0xC7,0xC3,0xC1,0x80,0xE0,0xE8,0xC6,0x1F,0x7F,0xFF,0x7F,
0xBF,0xFF,0xFE,0xFF,0xCF,0xC3,0x81,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x80,0xE4,0xFA,0x7C,0x1F,0x0F,0x0F,0x3F,0x7F,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xDF,0xEF,0xE7,0xF3,0xFB,0xFF,0xFF,
0xFF,0xFF,0xFF,0xF6,0xFE,0xFF,0xDF,0xFF,0xFF,0xFF,0xFF,0xF9,0xF8,0xFC,0xFE,0xFE,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0x7C,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,0xC0,0xC6,0xC0,0xC0,0xC0,
0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0x70,0x70,0x70,0x74,0x74,0x70,0xE0,0xF0,0xF0,
0xF8,0xF8,0xFC,0xFC,0xFC,0xFC,0xFC,0xF8,0xF0,0xE6,0x86,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0xC2,0xFC,0xFF,0x7F,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x02,0x01,
0x13,0x07,0x07,0x0F,0x1F,0x1F,0x3F,0x3F,0x7F,0x7F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0x7F,0x7F,0x7F,0x3F,0x3F,0x1F,0x1F,0x1F,0x2F,0x9F,0x7F,0x7F,0xFF,
0xFF,0xDF,0x0F,0x1F,0x3F,0x7B,0x71,0xE1,0x00,0xD0,0xE0,0xF0,0xF0,0x30,0x18,0x18,
0x0C,0x0E,0x0E,0x07,0x07,0x07,0x03,0x03,0x01,0x01,0x01,0xE0,0xF8,0xFE,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xE3,0x80,0xC1,0xC0,0x00,0xC0,0x00,0x01,0x03,0x03,
0x03,0x01,0x00,0x00,0x00,0x01,0x01,0x01,0x05,0x01,0x03,0x07,0x0F,0x0E,0x3F,0x1C,
0x38,0xF8,0xE0,0xE0,0xE0,0xE0,0xE0,0xE0,0xA0,0x00,0x60,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x7F,0xFF,0xFF,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x60,0xC0,0xC8,
0xE8,0xEC,0xF4,0xF4,0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0xF0,0xF8,0xF8,0xF0,0xF0,0xF0,
0xE0,0xC0,0xC0,0x80,0x40,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x00,0x1F,
0x3F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x17,0x03,0x00,0x00,0x00,0x00,0x00,
0x00,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x81,0xFE,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xE3,0x00,0x38,0x7C,0x7C,0xFC,0xFE,
0xFE,0xFE,0x7E,0x7E,0x7C,0x3C,0x1A,0x00,0x80,0xC0,0xE0,0xE0,0xC0,0x00,0x00,0x00,
0xE0,0xF0,0xFD,0x1F,0x0F,0x0F,0x0F,0x0F,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x01,0x0F,0x9F,0x7E,0xF8,0xE0,0xC0,0x00,0x01,0xFE,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFE,0xFE,0xFC,0xFC,0xFC,0xFC,0xFD,0xFD,0x99,
0x81,0xC0,0xC7,0xCF,0xEF,0x7F,0xFF,0xE7,0x08,0x00,0xC8,0xF0,0xF8,0xFB,0xFB,0xF8,
0xF8,0xF8,0xFC,0xFE,0xFE,0xFE,0xFE,0xFC,0xE0,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x7F,0x7F,0x3F,0x3E,0x30,0x70,
0xEE,0xFC,0xFC,0xFC,0xFC,0xFC,0xE8,0xF7,0xFF,0xEF,0xEF,0xFF,0xF7,0xFF,0xFC,0xFE,
0xE7,0x03,0x01,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x83,0x87,0x0E,0x0E,0xAD,0x9F,0xBF,
0x3F,0x9F,0xBF,0xBF,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,0x3F,0x3F,0x3F,0x1F,0x1F,
0x1F,0x1F,0x1F,0x0F,0x0F,0x2F,0x2F,0x0F,0x0F,0x0F,0x0F,0x0F,0x07,0x01,0x00,0x01,
0x01,0x01,0x01,0x00,0x00,0x00,0x07,0x0F,0x0E,0x0C,0x1F,0x1F,0x1F,0x1F,0x3F,0x3F,
0x7F,0x7F,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x7F,0x3B,0xC7,0xCF,0x1F,0x1F,
0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x3F,0x3E,0x3E,0x3D,0x00,0x00,0x00,0xC0,
0xC0,0xE0,0x00,0xC0,0xC1,0x07,0x8F,0x8F,0x9F,0x3F,0x7F,0x7F,0x7F,0x7F,0x7F,0x7F,
0x7F,0x7C,0x7C,0x78,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
};

checkbusy()
{
	EN=1;
	RW=1;
	RS=0;
	LCD=0XFF;
}

writecode(unsigned char dat) //???
{ 
	checkbusy();
	EN=1;
	RW=0;
	RS=0;
	LCD=dat;
	EN=1;
	EN=0;
}
writedata(unsigned char dat) //???
{
	checkbusy();
	EN=1;
	RW=0;
	RS=1;
	LCD=dat;
	EN=1;
	EN=0;
}
//??????
void LCDDisplay(unsigned char page,unsigned char lineaddress, unsigned char table[8][128])
{
	for(i=0;i<8;i++)
	{
		if(lineaddress<0X80)
		{
			CS1=0;
			CS2=0;
		}
		writecode(page+i);
		writecode(lineaddress);
		for(j=0;j<64;j++)
		{
			writedata(table[i][j]);
			lineaddress+=1;
		}
		if(lineaddress>=0X80)
		{
			CS1=0;
			CS2=1;
			lineaddress=lineaddress-0X40;
		}
		writecode(page+i);
		writecode(lineaddress);
		for(j=64;j<128;j++)
		{
			writedata(table[i][j]);
			lineaddress+=1;
		}
		if(lineaddress>=0X80)
		{
			lineaddress=lineaddress-0X40;
		} 
	}
	
}

void lcdinit()
{
	writecode(0X3F);
	writecode(0XC0);
	writecode(0XB8);
	writecode(0X40);
}

main()
{
	int i = 0;
	Initiallize_LCD();
	for (i = 0; i < 10; i++){
		ShowString(0,0,Display); //从第一个符允际示
		ShowString(0,1,Display+16);//第ニ行从第17个字符写起，0是第一个字符
	}
	LCDDisplay(0Xb8,0X40,&ch);
	while(1);
}